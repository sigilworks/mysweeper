!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a){"use strict;";var b=a("./gameboard"),c=a("./constants").Modes,d=a("./constants").PresetLevels,e=a("./constants").PresetSetups,f=a("./validators").BoardDimensions,g=a("./validators").MineCount,h=a("./constants").VERSION,i=a("./constants").MAX_GRID_DIMENSIONS,j=a("./constants").MINEABLE_SPACES_MULTIPLIER,k=function(a){return~~(Math.pow(a,2)*j)},l=function(a,b){null==b&&(b=!1),a[b?"removeClass":"addClass"]("disabled"),a.find("input").prop("readonly",!b)},m=function(a){return l(a,!0)};$(function(){var a=$("#mine-count").siblings(".advice").find("span"),j="ul.preset > li:not(:has(label[for$='-mode']))",n="ul.custom > li:not(:has(label[for$='-mode']))";a.html(k($("#dimensions").attr("placeholder"))),$("#dimensions").siblings(".advice").find("span").html(i+" x "+i),$("#preset-mode").on("click",function(){m($(j)),l($(n))}).click(),$("#custom-mode").on("click",function(){m($(n)),l($(j)),$("#dimensions").focus()}),$.each($("label[for^='level-']"),function(a,b){var c=$(b).attr("for").substring("level-".length).toUpperCase(),d=e[c].dimensions,f=e[c].mines,g=$(b).find(".advice");g.html(" ("+d+" x "+d+", "+f+" mines)")}),$("#dimensions").on("keyup",function(){var b=$(this);$("#dimensions-mirror").val(b.val()),a.html(k(b.val())+".")}),$("form").on("submit",function(){var a=$("[name=mode-select]:checked").val(),i={};if(a===c.PRESET){var j=$("[name=preset-level]:checked").val(),l=Object.keys(d).filter(function(a){return d[a]===j}).pop();i.isCustom=!1,i.dimensions=e[l].dimensions,i.mines=e[l].mines}else{i.isCustom=!0;var m=$("#dimensions").val()||+$("#dimensions").attr("placeholder"),n=$("#mine-count").val()||+$("#mine-count").attr("placeholder");try{i.dimensions=f.validate(m)?+m:9,i.mines=g.validate(n,k(i.dimensions))?n:1}catch(o){return console.log("e: %o",o),$("#validation-warnings").html(o.message).show(),!1}i.theme=$("#color-theme").val()}return $("#mines-display").find("span").html(i.mines),$(".version").html(h),window.gameboard=new b(i).render(),$("#validation-warnings").hide(),$("#options-card").hide(),$("#board-card").fadeIn(),!1}),$("#board-card").on("click","a.replay",function(){window.location.reload()})})},{"./constants":3,"./gameboard":7,"./validators":22}],2:[function(a,b){"use strict;";var c={COL_SPACING:"   ",MINED_SQUARE:"*",BLANK_SQUARE:".",RENDERED_MAP:"%o",DEFAULT_TRANSFORMER:function(a){return a},_makeTitle:function(a){return a.split("").join(" ").toUpperCase()},_displayRowNum:function(a){return"       ["+a+"]\n"},_toSymbols:function(a,b){var c=this;return a.reduce(function(a,d,e){return a+=b(d).join(c.COL_SPACING).toLowerCase()+c._displayRowNum(e)},"\n")},_validate:function(a){if(Array.isArray(a)&&a.length)return a;throw"No values present."},_getRenderedMap:function(a){var b=this._validate(this.values);return this._toSymbols(b,a)},to:function(a){return this.$log=a,this},withValues:function(a){return this.values=this._validate(a),this},viewGame:function(){var a=this,b=function(b){return b.map(function(b){return b.isMined()?a.MINED_SQUARE:0===b.getDanger()?a.BLANK_SQUARE:b.getDanger()})};this.$log([this._makeTitle("gameboard"),this.RENDERED_MAP].join("\n"),this._getRenderedMap(b))},viewMines:function(){this.$log([this._makeTitle("mine placements"),this.RENDERED_MAP].join("\n"),this._getRenderedMap(this.DEFAULT_TRANSFORMER))}};b.exports=c},{}],3:[function(a,b){"use strict;";var c=Object.freeze({VERSION:"beta5",MAX_GRID_DIMENSIONS:25,MINEABLE_SPACES_MULTIPLIER:.33,DefaultConfig:{dimensions:9,mines:1,board:"#board",timer:500,isCountdown:!0,debug_mode:!0,theme:"LIGHT"},Symbols:{CLOSED:"x",OPEN:"_",FLAGGED:"f",MINED:"*"},Flags:{OPEN:"F_OPEN",MINED:"F_MINED",FLAGGED:"F_FLAGGED",INDEXED:"F_INDEXED"},Glyphs:{FLAG:"x",MINE:"Ä"},Modes:{PRESET:"P",CUSTOM:"C"},PresetLevels:{BEGINNER:"B",INTERMEDIATE:"I",EXPERT:"E"},PresetSetups:{BEGINNER:{dimensions:9,mines:9,timer:300},INTERMEDIATE:{dimensions:12,mines:21,timer:420},EXPERT:{dimensions:15,mines:67,timer:540}},Themes:{LIGHT:"light",DARK:"dark"},MessageOverlay:"#flash",MobileDeviceRegex:/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/,Scoreboard:{DIGITS:3,FX_DURATION:800,OUT_OF_RANGE:"MAX"},ScoringRules:{DANGER_IDX_MULTIPLIER:1,BLANK_SQUARE_PTS:0,FLAG_MINED:25,MISFLAG_UNMINED:10,UNFLAG_MINED:25,MISUNFLAG_MINED:10,USERMOVES_MULTIPLIER:10,MISFLAGGED_MULTIPLIER:10,FLAGGED_MINES_MULTIPLIER:10}});b.exports=c},{}],4:[function(a,b){"use strict;";function c(a){this.el=document.getElementById("#"===a.charAt(0)?a.substring(1):a),this.$el=$(a),this.$m1=this.$el.find("#m1"),this.$m2=this.$el.find("#m2"),this.$s1=this.$el.find("#s1"),this.$s2=this.$el.find("#s2"),this.freeze=!1}var d=a("./lib/flippable");c.prototype={constructor:c,_increment:function(a){a.forEach(function(a){this._flip(a[0],a[1])},this)},update:function(a,b){var c=String(a),d=String(b),e=[c,d].map(function(a){var b=String(a).split("");return b.length<2&&b.unshift("0"),b});this._increment([[this.$s2,e[1][1]],[this.$s1,e[1][0]],[this.$m2,e[0][1]],[this.$m1,e[0][0]]])}},d(0,"span").call(c.prototype),b.exports=c},{"./lib/flippable":10}],5:[function(a,b){"use strict;";function c(a){return{board:a,neighborhood:{NORTH:[1,0],NORTHEAST:[1,1],EAST:[0,1],SOUTHEAST:[-1,1],SOUTH:[-1,0],SOUTHWEST:[-1,-1],WEST:[0,-1],NORTHWEST:[1,-1]},forSquare:function(a,b){if(+a>=0&&+b>=0){var c=this,d=0,e=Object.keys(this.neighborhood);return e.forEach(function(e){var f=c.neighborhood[e][0],g=c.neighborhood[e][1],h=c.board.getSquareAt(a+f,b+g);h&&h.isMined()&&d++}),d||""}return null}}}b.exports=c},{}],6:[function(a,b){"use strict;";function c(){var a=[].slice.call(arguments),b=/\{(\d+)\}/g,c=function(a,c){return(a||"").replace(b,function(a,b){return c[+b]||""})};this.message=c(a[0],a.slice(1)),Error.call(this,this.message),Error.captureStackTrace(this,arguments.callee),this.stack=Error().stack}function d(){c.apply(this,arguments)}c.prototype=new Error,c.prototype.constructor=c,c.prototype.getTrace=function(){return this.stack.replace(/↵\s+/g,"\n  ")},c.prototype.name="MysweeperError",d.prototype=new c,d.prototype.constructor=d,d.prototype.name="ValidationError",b.exports.MysweeperError=c,b.exports.ValidationError=d},{}],7:[function(a,b){"use strict;";function c(a){this.board=new d,this.dimensions=+a.dimensions||j.dimensions,this.mines=+a.mines||j.mines,this.$el=$(a.board||j.board),this.isCustom=a.isCustom||!1,this.emitter=new n(o),this.debug_mode=a.debug_mode||j.debug_mode,u.debug_mode=this.debug_mode,this.theme=this._setColorTheme(a.theme||j.theme),this.flashContainer=$(i),this.isMobile=this._checkForMobile(),this.userMoves=0,this.dangerCalc=new e(this),this.clock=new l(0,+a.timer||j.timer,a.isCountdown||j.isCountdown,this.emitter),this.countdown=new m("#countdown"),this.scorekeeper=new s(this),this.scoreboard=new t(0,"#score-display"),this._loadBoard(),this._renderGrid(),this.emitter.trigger("gb:start",this.board,this.$el.selector),this.clock.start()}var d=a("./lib/multimap"),e=a("./danger-calculator"),f=a("./square"),g=a("./serializer"),h=a("./constants").Glyphs,i=a("./constants").MessageOverlay,j=a("./constants").DefaultConfig,k=a("./constants").MobileDeviceRegex,l=a("./timer"),m=a("./countdown"),n=a("./transcribing-emitter"),o=a("./transcription-strategy"),p=a("./theme-styler"),q=a("./console-renderer"),r=a("./minelayer"),s=a("./scorekeeper"),t=a("./scoreboard"),u=function v(){v.debug_mode&&console.log.apply(console,arguments)};c.prototype={constructor:c,_loadBoard:function(){for(var a=this.dimensions,b=this.mines,c=function(a,b){for(var c=[],d=0;b>d;++d)c[d]=new f(a,d);return c},d=0;a>d;++d)this.board.set(d,c(d,a));this._determineMineLocations(a,b),this._precalcDangerIndices(),this.debug_mode&&(this.toConsole(),this.toConsole(!0))},_renderGrid:function(){this._createHTMLGrid(this.dimensions),this._setupEventListeners(),this._setColorTheme(this.theme)},_determineMineLocations:function(a,b){var c=new r(b,a),d=this;c.forEach(function(a){d.getSquareAt(a[0],a[1]).mine()})},_precalcDangerIndices:function(){var a=this;this.board.values().reduce(function(a,b){return a.concat(b.filter(function(a){return!a.isMined()}))},[]).forEach(function(b){b.setDanger(a.dangerCalc.forSquare(b.getRow(),b.getCell()))})},_createHTMLGrid:function(a){for(var b="",c=0;a>c;++c)b+="<tr id='row"+c+"'>"+[].join.call({length:a+1},"<td></td>")+"</tr>";this.$el.append(b)},_setColorTheme:function(a){return p.set(a,this.$el),a},_checkForMobile:function(){return k.test(navigator.userAgent.toLowerCase())},_setupEventListeners:function(){this.isMobile?this.$el.hammer().on({tap:this._handleClick.bind(this),hold:this._handleRightClick.bind(this)},"td, td > span"):this.$el.on({click:this._handleClick.bind(this),contextmenu:this._handleRightClick.bind(this)},"td, td > span"),this.emitter.on("sq:open",function(a){u("Opening square at (%o, %o).",a.getRow(),a.getCell())}),this.emitter.on("sq:close",function(a){u("Closing square at (%o, %o).",a.getRow(),a.getCell())}),this.emitter.on("sq:flag",function(a){u("Flagging square at (%o, %o).",a.getRow(),a.getCell())}),this.emitter.on("sq:unflag",function(a){u("Unflagging square at (%o, %o).",a.getRow(),a.getCell())}),this.emitter.on("gb:start",function(){u("Let the game begin!",arguments)}),this.emitter.on("gb:end:win",function(){u("Game over! You win!")}),this.emitter.on("gb:end:over",function(){u("Game over! You're dead!")});var a=this;this.emitter.on("score:change score:change:final",function(){a.scoreboard.update(a.scorekeeper.score)}),this.emitter.on("timer:start timer:stop timer:change timer:reset",function(b,c){a.countdown.update(b,c)})},_removeEventListeners:function(){this.$el.off(),this.$el.hammer().off()},_handleClick:function(a){var b=$(a.target),c="span"===b.prop("tagName").toLowerCase()?b.parent():b,d=c.data("square");if(d.isMined()&&0===this.userMoves&&(this.getSquares().forEach(function(a){a.unmine()}),this._determineMineLocations(this.dimensions,this.mines),this._precalcDangerIndices(),this.debug_mode&&(this.toConsole(),this.toConsole(!0))),this.userMoves++,!d.isClosed()||d.isMined()||d.isFlagged()){if(d.isMined()&&!d.isFlagged())return c.addClass("killer-mine"),this._gameOver()}else this._openSquare(d),!d.getDanger()>0&&this._recursiveReveal(d);this._evaluateForGameWin()},_handleRightClick:function(a){var b=$(a.target),c="span"===b.prop("tagName").toLowerCase()?b.parent():b,d=c.data("square");return a.preventDefault(),this.userMoves++,d.isClosed()&&!d.isFlagged()?this._flagSquare(d):d.isFlagged()&&(this._unflagSquare(d),this._closeSquare(d)),this._evaluateForGameWin(),!1},_recursiveReveal:function(a){var b=Object.keys(this.dangerCalc.neighborhood),c=a.getRow(),d=a.getCell(),e=this;b.forEach(function(a){var b=e.dangerCalc.neighborhood[a][0],f=e.dangerCalc.neighborhood[a][1],g=e.getSquareAt(c+b,d+f);g&&!g.isMined()&&!g.isFlagged()&&g.isClosed()&&(e._openSquare(g),(!g.getDanger()||!g.getDanger()>0)&&e._recursiveReveal(g))})},_openSquare:function(a,b){a.open(),this._renderSquare(a),b=null==b?!0:b,b&&this.emitter.trigger("sq:open",a,this.getGridCell(a))},_closeSquare:function(a,b){a.close(),this._renderSquare(a),b=null==b?!0:b,b&&this.emitter.trigger("sq:close",a,this.getGridCell(a))},_flagSquare:function(a,b){a.flag(),this._renderSquare(a),b=null==b?!0:b,this.getGridCell(a).removeClass("closed"),b&&this.emitter.trigger("sq:flag",a,this.getGridCell(a))},_unflagSquare:function(a,b){a.unflag(),this._renderSquare(a),b=null==b?!0:b,b&&this.emitter.trigger("sq:unflag",a,this.getGridCell(a))},_getOpenedSquaresCount:function(){return this.getSquares().filter(function(a){return a.isOpen()}).length},_evaluateForGameWin:function(){var a=this.getSquares().filter(function(a){return!a.isMined()}).length;return a===this._getOpenedSquaresCount()?this._gameWin():void 0},_flashMsg:function(a,b){this.flashContainer.addClass(b?"game-over":"game-win").html(a).show()},_prepareFinalReveal:function(){var a=this;this.getSquares().filter(function(a){return a.isFlagged()}).forEach(function(b){a.getGridCell(b).find(".danger").html(b.getDanger()),a._unflagSquare(b,!1)}),this._removeEventListeners(),this.clock.stop(),this.scorekeeper.close()},_gameWin:function(){this._prepareFinalReveal(),this.$el.addClass("game-win"),this.$el.find(".square").removeClass("closed flagged").addClass("open"),u("---  GAME WIN!  ---"),u("User moves: %o",this.userMoves),this._flashMsg('<span>Game Over!</span><a href="#" class="replay">Click here to play again...</a>'),this.emitter.trigger("gb:end:win",this.board,this.$el.selector)},_gameOver:function(){this._prepareFinalReveal(),this.$el.addClass("game-over"),this.$el.find(".square").removeClass("closed flagged").addClass("open"),u("---  GAME OVER!  ---"),this._flashMsg('<span>Game Over!</span><a href="#" class="replay">Click here to play again...</a>',!0),this.emitter.trigger("gb:end:over",this.board,this.$el.selector)},_renderSquare:function(a){var b=this.getGridCell(a),c=function(a){return a.isFlagged()?h.FLAG:a.isMined()?h.MINE:a.getDanger()?a.getDanger():""},d=$("<span />",{"class":"danger",html:c(a)});b.empty().append(d),b.removeClass().addClass("square").addClass("cell"+a.getCell()).addClass(a.getState().join(" ")),b.data("square",a)},render:function(){return this.getSquares().forEach(this._renderSquare,this),this},getGridCell:function(a){return this.$el.find("#row"+a.getRow()).find("td").eq(a.getCell())},getSquareAt:function(a,b){var a=this.board.get(a);return a&&a[0]&&a[0][b]?a[0][b]:null},getSquares:function(){return this.board.values().reduce(function(a,b){return a.concat(b)},[])},"export":function(){return g.export(this)},toJSON:function(){return this.board.values().join(", ")},toConsole:function(a){var b=q.to(u).withValues(this.board.values());return a?b.viewGame():b.viewMines()}},b.exports=c},{"./console-renderer":2,"./constants":3,"./countdown":4,"./danger-calculator":5,"./lib/multimap":12,"./minelayer":13,"./scoreboard":14,"./scorekeeper":15,"./serializer":16,"./square":17,"./theme-styler":18,"./timer":19,"./transcribing-emitter":20,"./transcription-strategy":21}],8:[function(a,b){"use strict;";function c(a){function b(){this._flags=arguments.length>0?e([].slice.call(arguments)):this.DEFAULT_STATE}var c=function(a){return parseInt(a,2)},d=function(a){return a.toString(2)},e=function(a){return f(a.map(function(a){return String(+a)}).reverse().join(""))},f=function(a,b){for(var c=[],b=b||4,d=b-a.length;d>0;c[--d]="0");return c.join("")+a},g=function(a){return function(){return this.has(this[a])}},h=function(a){return~a.indexOf("_")&&(a=a.substring(a.indexOf("_")+1)),"is"+a.charAt(0).toUpperCase()+a.substring(1)},i=function(a,b){if(a.length){b._states=[];for(var c=0,d=a.length;d>c;++c){var e=String(a[c]).toUpperCase(),i=e.toLowerCase(),j=Math.pow(2,c),k=h(i),l=g(e);b[e]=j,b._states[c]=i,b[k]=l}b.DEFAULT_STATE=f("",c)}};return b.prototype={constructor:b,has:function(a){return!!(c(this._flags)&a)},set:function(a){return this._flags=f(d(c(this._flags)|a))},unset:function(a){return this._flags=f(d(c(this._flags)&~a))},toJSON:function(){return{_flags:this._flags}}},b.withDefaults=function(a){return new b(a)},i(a,b.prototype),b}b.exports=c},{}],9:[function(a,b){"use strict;";function c(){this._events={}}c.prototype={constructor:c,on:function(a,b){return a.split(/\s+/g).forEach(function(a){this._events[a]=this._events[a]||[],this._events[a].push(b)},this),this},off:function(a,b){return a.split(/\s+/g).forEach(function(a){this._events[a]!==!1&&this._events[a].splice(this._events[a].indexOf(b),1)},this),this},trigger:function(a){if(this._events[a]!==!1)for(var b=0,c=this._events[a].length;c>b;++b)this._events[a][b].apply(this,[].slice.call(arguments,1));return this}},b.exports=c},{}],10:[function(a,b){"use strict;";var c=function(a,b){if(!(this instanceof c))return new c(a,b);var d=function(a){return"<"+a+" />"},e=function(a){var b="a,abbr,acronym,address,applet,area,article,aside,audio,b,base,basefont,bdi,bdo,bgsound,big,blink,blockquote,body,br,button,canvas,caption,center,cite,code,col,colgroup,content,data,datalist,dd,decorator,del,details,dfn,dir,div,dl,dt,element,em,embed,fieldset,figcaption,figure,font,footer,form,frame,frameset,h1,h2,h3,h4,h5,h6,head,header,hgroup,hr,html,i,iframe,img,input,ins,isindex,kbd,keygen,label,legend,li,link,listing,main,map,mark,marquee,menu,menuitem,meta,meter,nav,nobr,noframes,noscript,object,ol,optgroup,option,output,p,param,plaintext,pre,progress,q,rp,rt,ruby,s,samp,script,section,select,shadow,small,source,spacer,span,strike,strong,style,sub,summary,sup,table,tbody,td,template,textarea,tfoot,th,thead,time,title,tr,track,tt,u,ul,var,video,wbr,xmp";return a=String(a).toLowerCase(),a&&!!~b.indexOf(a)?a:"span"};return function(){this._flipDuration=+a||null==a?800:0,this._flipWrapper=e(b),this._flip=function(a,b){a.html()!==b&&a.wrapInner($(d(this._flipWrapper))).find(this._flipWrapper).delay(this._flipDuration).slideUp(this._flipDuration,function(){$(this).parent().html(b)})}}};b.exports=c},{}],11:[function(a,b){var c=function(){"use strict;";function a(){this.m=4294967296,this.a=1664525,this.c=1013904223,this.seed=void 0,this.z=void 0,this.setSeed()}return a.prototype={constructor:a,setSeed:function(a){this.z=this.seed=a||Math.round(Math.random()*this.m)},getSeed:function(){return this.seed},rand:function(){return this.z=(this.a*this.z+this.c)%this.m,this.z/this.m}},a}();b.exports=c},{}],12:[function(a,b){"use strict;";function c(){this._table=[]}c.prototype={constructor:c,get:function(a){return this._table[a]},set:function(a,b){(this._table[a]||(this._table[a]=[])).push(b)},forEach:function(a){return[].forEach.call(this.values(),a)},values:function(){var a=this;return Object.keys(this._table).map(function(b){return a._table[b]}).reduce(function(a,b){return a.concat(b)},[])},clear:function(){this._table={}},size:function(){return Object.keys(this._table).length}},b.exports=c},{}],13:[function(a,b){"use strict;";function c(a,b){this.generator=new d,this.mines=+a||0,this.dimensions=+b||0;for(var c=[],e=this,f=function(){return e.generator.rand()*Math.pow(e.dimensions,2)|0},g=0;a>g;++g){var h=f();~c.indexOf(h)?a++:c.push(h)}return this.locations=c.map(function(a){var c=~~(a/b),d=a%b;return[c,d]}),this.locations}var d=a("./lib/lcgenerator");b.exports=c},{"./lib/lcgenerator":11}],14:[function(a,b){"use strict;";function c(a,b){this.score=a||0,this.initial=a,this.el=document.getElementById("#"===b.charAt(0)?b.substring(1):b),this.$el=$(b),this.$L=this.$el.find("#sc1"),this.$M=this.$el.find("#sc2"),this.$R=this.$el.find("#sc3"),this.update(this.initial)}function d(a){var b=String(a),c=b.length;return c>f&&(b=g,c=g.length),[b[c-3]||"0",b[c-2]||"0",b[c-1]||"0"]}var e=a("./constants").Scoreboard.FX_DURATION,f=a("./constants").Scoreboard.DIGITS,g=a("./constants").Scoreboard.OUT_OF_RANGE,h=a("./lib/flippable");c.prototype={constructor:c,_increment:function(a){a.forEach(function(a){this._flip(a[0],a[1])},this)},update:function(a){if(a){var b=d(a);this._increment([[this.$R,b[2]],[this.$M,b[1]],[this.$L,b[0]]])}}},h(e).call(c.prototype),b.exports=c},{"./constants":3,"./lib/flippable":10}],15:[function(a,b){"use strict;";function c(a){var b=this;this.callbacks={up:function(a){this.score+=d(a),this.emitter.trigger("score:change",this.score)}.bind(this),down:function(a){this.score=this.score-e(a)<=0?0:this.score-e(a),this.emitter.trigger("score:change",this.score)}.bind(this)},this.finalizers={forOpeningSquares:function(a){var b=a.userMoves,c=Math.pow(a.dimensions,2)-a.mines;return 1-10*~~(b/c)},forTimePassed:function(a){var b=a.clock.initial,c=a.clock.seconds;return 100-~~(c/b*100)},forFewestMoves:function(a){var b=Math.pow(a.dimensions,2);return~~(Math.sqrt(b-a.userMoves)*f.USERMOVES_MULTIPLIER)},forFinalMisflaggings:function(a){var b=a.getSquares(),c=b.filter(function(a){return a.isFlagged()}),d=c.filter(function(a){return!a.isMined()});return d.length*f.MISFLAGGED_MULTIPLIER||0},forCorrectFlagging:function(a){var b=a.mines,c=a.getSquares(),d=(c.filter(function(a){return a.isFlagged()}),c.filter(function(a){return a.isMined()})),e=~~(d.length/b);return Math.ceil(b*f.FLAGGED_MINES_MULTIPLIER*e)}},this.queue=[],this.final=[],this.gameboard=a,this.emitter=a.emitter,this.score=0,this.nsu=this._determineSignificantUnit(),this.endGame=!1,this.timer=setInterval(this._tick.bind(b),this.nsu),console.log("Scorekeeper initialized.  :score => %o, :timer => %o",this.score,this.timer),this._setupEventListeners()}function d(a){return Math.abs(+a)||0}function e(a){return-1*Math.abs(+a)||0}var f=a("./constants").ScoringRules;c.prototype={_setupEventListeners:function(){var a={"sq:open":function(a){this.up(a.getDanger()>0?a.getDanger()*f.DANGER_IDX_MULTIPLIER:f.BLANK_SQUARE_PTS)},"sq:close":function(){},"sq:flag":function(a){a.isMined()?this.deferredUp(f.FLAG_MINED):this.deferredDown(f.MISFLAG_UNMINED)},"sq:unflag":function(a){a.isMined()?this.deferredDown(f.UNFLAG_MINED):this.deferredUp(f.MISUNFLAG_MINED)},"gb:start":function(){this.endGame=!1},"gb:end:win":function(){this.endGame=!0},"gb:end:over":function(){this.endGame=!0}};for(var b in a)this.emitter.on(b,a[b].bind(this))},_determineSignificantUnit:function(){var a=(this.gameboard.isCustom,this.gameboard.clock.seconds),b=1e3,c=function(a){return Math.max(a,1*b)};return a/100>=1?c(~~(a/250*b)):a/10>=1?c(5*b):1*b},_binarySearch:function(a){for(var b=0,c=this.queue.length;c>b;){var d=~~(b+c>>1);a.time<this.queue[d].time?c=d:b=d+1}return b},_enqueue:function(a){return this.queue.splice(this._binarySearch(a),0,a)},_processEvent:function(a){var b=this.callbacks[a.type];return null!=b?(b.length>1?b.call(this,a.pts,function(a){return a?void 0:void 0}):console.log("<score event: %o>: :old [%o]",b.name,this.score),b.call(this,a.pts),console.log("...:new => [%o]",this.score)):console.log("[Scorekeeper] could not find function "+a.type)},_processFinalizers:function(){for(var a in this.finalizers)console.log("<finalizer: %o>: :old [%o] => :new [%o]... ",a,this.score,this.score+=this.finalizers[a](this.gameboard));this.final.forEach(function(a){this.score+=a},this),this.emitter.trigger("score:change:final",this.score)},_tick:function(){for(var a=this._binarySearch({time:(new Date).getTime()}),b=0;a>b;){var c=this,d=function(){return c._processEvent(c.queue[b]),b+=1};d()}return this.queue.splice(0,a)},_addScoreToQueue:function(a,b){return this._enqueue({time:+new Date+this.nsu,type:a,pts:b})},up:function(a){console.log("up: %o",a),this.callbacks.up(a)},down:function(a){console.log("down: %o",a),this.callbacks.down(a)},deferredUp:function(a){console.log("Queueing `up` score event of %o",d(a)),this._addScoreToQueue("up",d(a))},deferredDown:function(a){console.log("Queueing `down` score event of %o",e(a)),this._addScoreToQueue("down",e(a))},finalUp:function(a){this.final.push(d(a))},finalDown:function(a){this.final.push(e(a))},getPendingScoreCount:function(){return this.queue.length},close:function(){clearInterval(this.timer),console.log("Clearing out remaining queue!");var a=this;this.queue.forEach(function(b){a._processEvent(b)}),this._processFinalizers(),console.info("FINAL SCORE: %o",this.score)},clear:function(){clearInterval(this.timer),this.queue.length=0,this.final.length=0,this.score=0}},b.exports=c},{"./constants":3}],16:[function(a,b){"use strict;";var c={"export":function(a){return{_meta:{timestamp:+new Date,score:a.scorekeeper.score,timer:a.clock.seconds,transcripts:a.emitter._transcripts||[],user:{}},options:{$el:a.$el.selector,board:a.board._table,scorekeeper:{queue:a.scorekeeper.queue,"final":a.scorekeeper.final},flashContainer:a.flashContainer.selector,theme:a.theme,debug_mode:a.debug_mode,dimensions:a.dimensions,mines:a.mines,userMoves:a.userMoves,isMobile:a.isMobile}}},"import":function(){}};b.exports=c},{}],17:[function(a,b){"use strict;";function c(a,b,d,e){return this instanceof c?(this.row=a,this.cell=b,this.state=e?new g(e):new g,this.danger=d==+d?+d:0,void(this.danger>0&&this.index())):new c(arguments)}var d=a("./lib/bit-flag-factory"),e=a("./constants").Symbols,f=a("./constants").Flags,g=new d([f.OPEN,f.MINED,f.FLAGGED,f.INDEXED]);c.prototype={constructor:c,getRow:function(){return this.row},getCell:function(){return this.cell},getDanger:function(){return this.danger},setDanger:function(a){a==+a&&(this.danger=+a,this.danger>0&&this.index())},getState:function(){var a=this;return Object.keys(e).filter(function(b){return a["is"+b.charAt(0)+b.substring(1).toLowerCase()]()}).map(function(a){return a.toLowerCase()})},close:function(){this.state.unset(this.state.F_OPEN)},open:function(){this.state.set(this.state.F_OPEN)},flag:function(){this.state.set(this.state.F_FLAGGED)},unflag:function(){this.state.unset(this.state.F_FLAGGED)},mine:function(){this.state.set(this.state.F_MINED)},unmine:function(){this.state.unset(this.state.F_MINED)},index:function(){this.state.set(this.state.F_INDEXED)},isClosed:function(){return!this.state.isOpen()},isOpen:function(){return this.state.isOpen()},isFlagged:function(){return this.state.isFlagged()},isMined:function(){return this.state.isMined()},isIndexed:function(){return this.state.isIndexed()},toJSON:function(){return{row:this.row,cell:this.cell,state:this.state,danger:this.danger}},toString:function(){return this.state.isMined()?e.MINED:this.state.isFlagged()?e.FLAGGED:this.state.isOpen()?e.OPEN:e.CLOSED}},b.exports=c},{"./constants":3,"./lib/bit-flag-factory":8}],18:[function(a,b){"use strict;";var c=a("./constants"),d={set:function(a,b){b||(b=$(c.DefaultConfig.board));var d=c.Themes[a],e=b.parents("body").siblings("head"),f=e.find("link"),g=function(a){return!!a.filter(function(){return!!~$(this).attr("href").indexOf(d)}).length},h=$("<link />",{rel:"stylesheet",type:"text/css",href:"css/"+d+".css"});g(f)||f.after(h)}};b.exports=d},{"./constants":3}],19:[function(a,b){"use strict;";function c(a,b,c,d){this.isCountdown=c,this.seconds=this.isCountdown?b:a,this.initial=a,this.max=b,this.emitter=d,this.freeze=!1}c.prototype={constructor:c,_renderInitial:function(){var a=this._toMinsSecs(this.seconds);this._publish(a[0]||0,a[1]||0)},_toMinsSecs:function(a){var b=~~(a/60),a=a%60;return[b,a]},_countdown:function(){var a=this,b=setInterval(function(){if(a.freeze)clearInterval(b);else if(a.seconds!==(a.isCountdown?0:a.max)){var c=a._toMinsSecs(a.seconds);a._publish("change",c[0],c[1]),a.isCountdown?a.seconds--:a.seconds++}else clearInterval(b),a._publish("change",0,0)},1e3)},_publish:function(a,b,c){this.emitter.trigger("timer:"+a,b,c)},getMinutes:function(){return+this._toMinsSecs(this.seconds)[0]},getSeconds:function(){return+this._toMinsSecs(this.seconds)[1]},start:function(){this.freeze=!1;var a=this._toMinsSecs(this.seconds);this._publish("start",a[0],a[1]),this._countdown()},stop:function(){this.freeze=!0;var a=this._toMinsSecs(this.seconds);this._publish("stop",a[0],a[1])},reset:function(){this.seconds=0,this._publish("reset",0,0)}},b.exports=c},{}],20:[function(a,b){"use strict;";function c(a){d.call(this),this._transcripts=[],this._strategy=a&&a.apply?a:e}var d=a("./lib/emitter"),e=a("./transcription-strategy");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.prototype.__trigger__=c.prototype.trigger,c.prototype.trigger=function(){var a=[].slice.call(arguments);this.__trigger__.apply(this,a),this._transcripts.push(this._strategy.apply(a))},b.exports=c},{"./lib/emitter":9,"./transcription-strategy":21}],21:[function(a,b){"use strict;";function c(a){var b=a instanceof jQuery?a[0]:a,c=function(a,b){function c(a){return a.substring(0,"cell".length).toLowerCase()}return"cell"===c(a)||"cell"===c(b)||a>b?1:b>a?-1:0};return b.parentNode.tagName.toLowerCase()+"#"+b.parentNode.id+" "+b.tagName.toLowerCase()+"."+b.className.split(" ").sort(c).join(".")}var d={apply:function(a){if(a&&a[0]){switch(a[0]){case"sq:open":case"sq:close":case"sq:flag":case"sq:unflag":case"sq:mine":"Square"===a[1].constructor.name&&(a[1]=JSON.stringify(a[1])),a[2]instanceof jQuery&&(a[2]=c(a[2]));break;case"gb:start":case"gb:end:win":case"gb:end:over":"Multimap"===a[1].constructor.name&&(a[1]=JSON.stringify(a[1]))}return a.unshift(+new Date),a}}};b.exports=d},{}],22:[function(a,b){"use strict;";var c=a("./constants"),d=a("./errors").ValidationError,e=function(a){return String(a).replace(/,/g,""),0!==a.length&&!isNaN(+a)&&isFinite(+a)},f={BoardDimensions:{validate:function(a){if(!e(a))throw new d("User entered {0}, which is not a number, and an invalid board dimension.",a);if(!(a<=c.MAX_GRID_DIMENSIONS))throw new d("User entered {0}, which is greater than the game's maximum grid dimensions",+a);return!0}},MineCount:{validate:function(a,b){if(console.log("mines: %o, maxPossible: %o",a,b),!e(a))throw new d("User entered {0}, which is not a number, and an invalid number of mines.",a);if(a>b)throw new d("User entered {0}, which is greater than the possible number of mines ({1}).",+a,b);return!0}}};b.exports=f},{"./constants":3,"./errors":6}],23:[function(a,b){!function(a,c){"use strict";function d(){e.READY||(e.event.determineEventTypes(),e.utils.each(e.gestures,function(a){e.detection.register(a)}),e.event.onTouch(e.DOCUMENT,e.EVENT_MOVE,e.detection.detect),e.event.onTouch(e.DOCUMENT,e.EVENT_END,e.detection.detect),e.READY=!0)}var e=function(a,b){return new e.Instance(a,b||{})};e.defaults={stop_browser_behavior:{userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},e.HAS_POINTEREVENTS=a.navigator.pointerEnabled||a.navigator.msPointerEnabled,e.HAS_TOUCHEVENTS="ontouchstart"in a,e.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android|silk/i,e.NO_MOUSEEVENTS=e.HAS_TOUCHEVENTS&&a.navigator.userAgent.match(e.MOBILE_REGEX),e.EVENT_TYPES={},e.DIRECTION_DOWN="down",e.DIRECTION_LEFT="left",e.DIRECTION_UP="up",e.DIRECTION_RIGHT="right",e.POINTER_MOUSE="mouse",e.POINTER_TOUCH="touch",e.POINTER_PEN="pen",e.UPDATE_VELOCITY_INTERVAL=20,e.EVENT_START="start",e.EVENT_MOVE="move",e.EVENT_END="end",e.DOCUMENT=a.document,e.plugins=e.plugins||{},e.gestures=e.gestures||{},e.READY=!1,e.utils={extend:function(a,b,d){for(var e in b)a[e]!==c&&d||(a[e]=b[e]);return a},each:function(a,b,d){var e,f;if("forEach"in a)a.forEach(b,d);else if(a.length!==c){for(e=0,f=a.length;f>e;e++)if(b.call(d,a[e],e,a)===!1)return}else for(e in a)if(a.hasOwnProperty(e)&&b.call(d,a[e],e,a)===!1)return},hasParent:function(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1},getCenter:function(a){var b=[],c=[];return e.utils.each(a,function(a){b.push("undefined"!=typeof a.clientX?a.clientX:a.pageX),c.push("undefined"!=typeof a.clientY?a.clientY:a.pageY)}),{pageX:(Math.min.apply(Math,b)+Math.max.apply(Math,b))/2,pageY:(Math.min.apply(Math,c)+Math.max.apply(Math,c))/2}},getVelocity:function(a,b,c){return{x:Math.abs(b/a)||0,y:Math.abs(c/a)||0}},getAngle:function(a,b){var c=b.pageY-a.pageY,d=b.pageX-a.pageX;return 180*Math.atan2(c,d)/Math.PI},getDirection:function(a,b){var c=Math.abs(a.pageX-b.pageX),d=Math.abs(a.pageY-b.pageY);return c>=d?a.pageX-b.pageX>0?e.DIRECTION_LEFT:e.DIRECTION_RIGHT:a.pageY-b.pageY>0?e.DIRECTION_UP:e.DIRECTION_DOWN},getDistance:function(a,b){var c=b.pageX-a.pageX,d=b.pageY-a.pageY;return Math.sqrt(c*c+d*d)},getScale:function(a,b){return a.length>=2&&b.length>=2?this.getDistance(b[0],b[1])/this.getDistance(a[0],a[1]):1},getRotation:function(a,b){return a.length>=2&&b.length>=2?this.getAngle(b[1],b[0])-this.getAngle(a[1],a[0]):0},isVertical:function(a){return a==e.DIRECTION_UP||a==e.DIRECTION_DOWN},stopDefaultBrowserBehavior:function(a,b){b&&a&&a.style&&(e.utils.each(["webkit","khtml","moz","Moz","ms","o",""],function(c){e.utils.each(b,function(b,d){c&&(d=c+d.substring(0,1).toUpperCase()+d.substring(1)),d in a.style&&(a.style[d]=b)})}),"none"==b.userSelect&&(a.onselectstart=function(){return!1
}),"none"==b.userDrag&&(a.ondragstart=function(){return!1}))},startDefaultBrowserBehavior:function(a,b){b&&a&&a.style&&(e.utils.each(["webkit","khtml","moz","Moz","ms","o",""],function(c){e.utils.each(b,function(b,d){c&&(d=c+d.substring(0,1).toUpperCase()+d.substring(1)),d in a.style&&(a.style[d]="")})}),"none"==b.userSelect&&(a.onselectstart=null),"none"==b.userDrag&&(a.ondragstart=null))}},e.Instance=function(a,b){var c=this;return d(),this.element=a,this.enabled=!0,this.options=e.utils.extend(e.utils.extend({},e.defaults),b||{}),this.options.stop_browser_behavior&&e.utils.stopDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior),this._eventStartHandler=e.event.onTouch(a,e.EVENT_START,function(a){c.enabled&&e.detection.startDetect(c,a)}),this._eventHandler=[],this},e.Instance.prototype={on:function(a,b){var c=a.split(" ");return e.utils.each(c,function(a){this.element.addEventListener(a,b,!1),this._eventHandler.push({gesture:a,handler:b})},this),this},off:function(a,b){var c=a.split(" ");return e.utils.each(c,function(a){this.element.removeEventListener(a,b,!1);var c=-1;e.utils.each(this._eventHandler,function(d,e){-1===c&&d.gesture===a&&d.handler===b&&(c=e)},this),c>-1&&this._eventHandler.splice(c,1)},this),this},trigger:function(a,b){b||(b={});var c=e.DOCUMENT.createEvent("Event");c.initEvent(a,!0,!0),c.gesture=b;var d=this.element;return e.utils.hasParent(b.target,d)&&(d=b.target),d.dispatchEvent(c),this},enable:function(a){return this.enabled=a,this},dispose:function(){return this.options.stop_browser_behavior&&e.utils.startDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior),e.utils.each(this._eventHandler,function(a){this.element.removeEventListener(a.gesture,a.handler,!1)},this),this._eventHandler.length=0,e.event.unbindDom(this.element,e.EVENT_TYPES[e.EVENT_START],this._eventStartHandler),this}};var f=null,g=!1,h=!1;e.event={bindDom:function(a,b,c){var d=b.split(" ");e.utils.each(d,function(b){a.addEventListener(b,c,!1)})},unbindDom:function(a,b,c){var d=b.split(" ");e.utils.each(d,function(b){a.removeEventListener(b,c,!1)})},onTouch:function(a,b,c){var d=this,i=function(i){var j=i.type.toLowerCase();if(!j.match(/mouse/)||!h){j.match(/touch/)||j.match(/pointerdown/)||j.match(/mouse/)&&1===i.which?g=!0:j.match(/mouse/)&&!i.which&&(g=!1),j.match(/touch|pointer/)&&(h=!0);var k=0;g&&(e.HAS_POINTEREVENTS&&b!=e.EVENT_END?k=e.PointerEvent.updatePointer(b,i):j.match(/touch/)?k=i.touches.length:h||(k=j.match(/up/)?0:1),k>0&&b==e.EVENT_END?b=e.EVENT_MOVE:k||(b=e.EVENT_END),(k||null===f)&&(f=i),c.call(e.detection,d.collectEventData(a,b,d.getTouchList(f,b),i)),e.HAS_POINTEREVENTS&&b==e.EVENT_END&&(k=e.PointerEvent.updatePointer(b,i))),k||(f=null,g=!1,h=!1,e.PointerEvent.reset())}};return this.bindDom(a,e.EVENT_TYPES[b],i),i},determineEventTypes:function(){var a;a=e.HAS_POINTEREVENTS?e.PointerEvent.getEvents():e.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],e.EVENT_TYPES[e.EVENT_START]=a[0],e.EVENT_TYPES[e.EVENT_MOVE]=a[1],e.EVENT_TYPES[e.EVENT_END]=a[2]},getTouchList:function(a){return e.HAS_POINTEREVENTS?e.PointerEvent.getTouchList():a.touches?a.touches:(a.identifier=1,[a])},collectEventData:function(a,b,c,d){var f=e.POINTER_TOUCH;return(d.type.match(/mouse/)||e.PointerEvent.matchType(e.POINTER_MOUSE,d))&&(f=e.POINTER_MOUSE),{center:e.utils.getCenter(c),timeStamp:(new Date).getTime(),target:d.target,touches:c,eventType:b,pointerType:f,srcEvent:d,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation(),this.srcEvent.preventDefault&&this.srcEvent.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return e.detection.stopDetect()}}}},e.PointerEvent={pointers:{},getTouchList:function(){var a=this,b=[];return e.utils.each(a.pointers,function(a){b.push(a)}),b},updatePointer:function(a,b){return a==e.EVENT_END?delete this.pointers[b.pointerId]:(b.identifier=b.pointerId,this.pointers[b.pointerId]=b),Object.keys(this.pointers).length},matchType:function(a,b){if(!b.pointerType)return!1;var c=b.pointerType,d={};return d[e.POINTER_MOUSE]=c===b.MSPOINTER_TYPE_MOUSE||c===e.POINTER_MOUSE,d[e.POINTER_TOUCH]=c===b.MSPOINTER_TYPE_TOUCH||c===e.POINTER_TOUCH,d[e.POINTER_PEN]=c===b.MSPOINTER_TYPE_PEN||c===e.POINTER_PEN,d[a]},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}},e.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(a,b){this.current||(this.stopped=!1,this.current={inst:a,startEvent:e.utils.extend({},b),lastEvent:!1,lastVEvent:!1,velocity:!1,name:""},this.detect(b))},detect:function(a){if(this.current&&!this.stopped){a=this.extendEventData(a);var b=this.current.inst.options;return e.utils.each(this.gestures,function(c){return this.stopped||b[c.name]===!1||c.handler.call(c,a,this.current.inst)!==!1?void 0:(this.stopDetect(),!1)},this),this.current&&(this.current.lastEvent=a),a.eventType==e.EVENT_END&&!a.touches.length-1&&this.stopDetect(),a}},stopDetect:function(){this.previous=e.utils.extend({},this.current),this.current=null,this.stopped=!0},extendEventData:function(a){var b=this.current.startEvent,c=this.current.lastVEvent;!b||a.touches.length==b.touches.length&&a.touches!==b.touches||(b.touches=[],e.utils.each(a.touches,function(a){b.touches.push(e.utils.extend({},a))}));var d,f,g=a.timeStamp-b.timeStamp,h=a.center.pageX-b.center.pageX,i=a.center.pageY-b.center.pageY,j=this.current.velocity;return c!==!1&&a.timeStamp-c.timeStamp>e.UPDATE_VELOCITY_INTERVAL?(j=e.utils.getVelocity(a.timeStamp-c.timeStamp,a.center.pageX-c.center.pageX,a.center.pageY-c.center.pageY),this.current.lastVEvent=a,j.x>0&&j.y>0&&(this.current.velocity=j)):this.current.velocity===!1&&(j=e.utils.getVelocity(g,h,i),this.current.velocity=j,this.current.lastVEvent=a),"end"===a.eventType?(d=this.current.lastEvent&&this.current.lastEvent.interimAngle,f=this.current.lastEvent&&this.current.lastEvent.interimDirection):(d=this.current.lastEvent&&e.utils.getAngle(this.current.lastEvent.center,a.center),f=this.current.lastEvent&&e.utils.getDirection(this.current.lastEvent.center,a.center)),e.utils.extend(a,{deltaTime:g,deltaX:h,deltaY:i,velocityX:j.x,velocityY:j.y,distance:e.utils.getDistance(b.center,a.center),angle:e.utils.getAngle(b.center,a.center),interimAngle:d,direction:e.utils.getDirection(b.center,a.center),interimDirection:f,scale:e.utils.getScale(b.touches,a.touches),rotation:e.utils.getRotation(b.touches,a.touches),startEvent:b}),a},register:function(a){var b=a.defaults||{};return b[a.name]===c&&(b[a.name]=!0),e.utils.extend(e.defaults,b,!0),a.index=a.index||1e3,this.gestures.push(a),this.gestures.sort(function(a,b){return a.index<b.index?-1:a.index>b.index?1:0}),this.gestures}},e.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:10,correct_for_drag_min_distance:!0,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1,drag_lock_min_distance:25},triggered:!1,handler:function(a,b){if(e.detection.current.name!=this.name&&this.triggered)return b.trigger(this.name+"end",a),void(this.triggered=!1);if(!(b.options.drag_max_touches>0&&a.touches.length>b.options.drag_max_touches))switch(a.eventType){case e.EVENT_START:this.triggered=!1;break;case e.EVENT_MOVE:if(a.distance<b.options.drag_min_distance&&e.detection.current.name!=this.name)return;if(e.detection.current.name!=this.name&&(e.detection.current.name=this.name,b.options.correct_for_drag_min_distance&&a.distance>0)){var c=Math.abs(b.options.drag_min_distance/a.distance);e.detection.current.startEvent.center.pageX+=a.deltaX*c,e.detection.current.startEvent.center.pageY+=a.deltaY*c,a=e.detection.extendEventData(a)}(e.detection.current.lastEvent.drag_locked_to_axis||b.options.drag_lock_to_axis&&b.options.drag_lock_min_distance<=a.distance)&&(a.drag_locked_to_axis=!0);var d=e.detection.current.lastEvent.direction;a.drag_locked_to_axis&&d!==a.direction&&(a.direction=e.utils.isVertical(d)?a.deltaY<0?e.DIRECTION_UP:e.DIRECTION_DOWN:a.deltaX<0?e.DIRECTION_LEFT:e.DIRECTION_RIGHT),this.triggered||(b.trigger(this.name+"start",a),this.triggered=!0),b.trigger(this.name,a),b.trigger(this.name+a.direction,a),(b.options.drag_block_vertical&&e.utils.isVertical(a.direction)||b.options.drag_block_horizontal&&!e.utils.isVertical(a.direction))&&a.preventDefault();break;case e.EVENT_END:this.triggered&&b.trigger(this.name+"end",a),this.triggered=!1}}},e.gestures.Hold={name:"hold",index:10,defaults:{hold_timeout:500,hold_threshold:1},timer:null,handler:function(a,b){switch(a.eventType){case e.EVENT_START:clearTimeout(this.timer),e.detection.current.name=this.name,this.timer=setTimeout(function(){"hold"==e.detection.current.name&&b.trigger("hold",a)},b.options.hold_timeout);break;case e.EVENT_MOVE:a.distance>b.options.hold_threshold&&clearTimeout(this.timer);break;case e.EVENT_END:clearTimeout(this.timer)}}},e.gestures.Release={name:"release",index:1/0,handler:function(a,b){a.eventType==e.EVENT_END&&b.trigger(this.name,a)}},e.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_min_touches:1,swipe_max_touches:1,swipe_velocity:.7},handler:function(a,b){if(a.eventType==e.EVENT_END){if(b.options.swipe_max_touches>0&&a.touches.length<b.options.swipe_min_touches&&a.touches.length>b.options.swipe_max_touches)return;(a.velocityX>b.options.swipe_velocity||a.velocityY>b.options.swipe_velocity)&&(b.trigger(this.name,a),b.trigger(this.name+a.direction,a))}}},e.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},handler:function(a,b){if(a.eventType!=e.EVENT_MOVE||e.detection.current.reachedTapMaxDistance){if(a.eventType==e.EVENT_END&&"touchcancel"!=a.srcEvent.type){var c=e.detection.previous,d=!1;if(e.detection.current.reachedTapMaxDistance||a.deltaTime>b.options.tap_max_touchtime)return;c&&"tap"==c.name&&a.timeStamp-c.lastEvent.timeStamp<b.options.doubletap_interval&&a.distance<b.options.doubletap_distance&&(b.trigger("doubletap",a),d=!0),(!d||b.options.tap_always)&&(e.detection.current.name="tap",b.trigger(e.detection.current.name,a))}}else e.detection.current.reachedTapMaxDistance=a.distance>b.options.tap_max_distance}},e.gestures.Touch={name:"touch",index:-1/0,defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(a,b){return b.options.prevent_mouseevents&&a.pointerType==e.POINTER_MOUSE?void a.stopDetect():(b.options.prevent_default&&a.preventDefault(),void(a.eventType==e.EVENT_START&&b.trigger(this.name,a)))}},e.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:.01,transform_min_rotation:1,transform_always_block:!1},triggered:!1,handler:function(a,b){if(e.detection.current.name!=this.name&&this.triggered)return b.trigger(this.name+"end",a),void(this.triggered=!1);if(!(a.touches.length<2))switch(b.options.transform_always_block&&a.preventDefault(),a.eventType){case e.EVENT_START:this.triggered=!1;break;case e.EVENT_MOVE:var c=Math.abs(1-a.scale),d=Math.abs(a.rotation);if(c<b.options.transform_min_scale&&d<b.options.transform_min_rotation)return;e.detection.current.name=this.name,this.triggered||(b.trigger(this.name+"start",a),this.triggered=!0),b.trigger(this.name,a),d>b.options.transform_min_rotation&&b.trigger("rotate",a),c>b.options.transform_min_scale&&(b.trigger("pinch",a),b.trigger("pinch"+(a.scale<1?"in":"out"),a));break;case e.EVENT_END:this.triggered&&b.trigger(this.name+"end",a),this.triggered=!1}}},"function"==typeof define&&define.amd?define(function(){return e}):"object"==typeof b&&b.exports?b.exports=e:a.Hammer=e}(window),function(a,b){"use strict";function c(a,c){a.event.bindDom=function(a,d,e){c(a).on(d,function(a){var c=a.originalEvent||a;c.pageX===b&&(c.pageX=a.pageX,c.pageY=a.pageY),c.target||(c.target=a.target),c.which===b&&(c.which=c.button),c.preventDefault||(c.preventDefault=a.preventDefault),c.stopPropagation||(c.stopPropagation=a.stopPropagation),e.call(this,c)})},a.Instance.prototype.on=function(a,b){return c(this.element).on(a,b)},a.Instance.prototype.off=function(a,b){return c(this.element).off(a,b)},a.Instance.prototype.trigger=function(a,b){var d=c(this.element);return d.has(b.target).length&&(d=c(b.target)),d.trigger({type:a,gesture:b})},c.fn.hammer=function(b){return this.each(function(){var d=c(this),e=d.data("hammer");e?e&&b&&a.utils.extend(e.options,b):d.data("hammer",new a(this,b||{}))})}}"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(["hammerjs","jquery"],c):c(a.Hammer,a.jQuery||a.Zepto)}(window)},{}]},{},[1,2,3,7,4,5,8,10,6,12,14,11,15,16,17,9,19,13,18,20,21,23,22]);